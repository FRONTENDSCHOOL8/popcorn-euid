import"./tailwind-zBIZP7u3.js";import{r as c,a as u,t as k}from"./css-LUmow4Y_.js";import{g as o,a as I}from"./delay-g6vF19wW.js";import{s as y}from"./storage-eNv634Ip.js";import{p as f}from"./pocketbase-UOLpUAtS.js";const L=o(".button-goBack"),E=o(".button-moveBack"),N=o(".signUp-container"),U=o(".signUp-form-before");function w(){history.back()}function P(){N.style.transform="translateX(0%)"}L.addEventListener("click",w);E.addEventListener("click",P);U.addEventListener("submit",e=>{e.preventDefault(),N.style.transform="translateX(-50%)"});const v=document.getElementById("phoneNumber"),s=o(".signUp-button-verify"),a=document.getElementById("agree"),A=/^010\d{4}\d{4}$/;function C(e){const t=e.target.value;console.log(t),A.test(t)?(c(s,"text-gray-500"),u(s,"signUp-verify-valid"),s.removeAttribute("disabled")):(c(s,"signUp-verify-valid"),s.setAttribute("disabled",""))}v.addEventListener("input",C);const S=Math.floor(Math.random()*9e5)+1e5;sessionStorage.setItem("verifyNumber",S);const m=sessionStorage.getItem("verifyNumber");function B(){Array.from(s.classList).includes("signUp-verify-valid")&&(alert(m),console.log(m))}async function x(){const e=o(".signUp-input-phoneNumber").value;console.log(e);const n=(await f.collection("users").getFullList("phoneNumber")).map(i=>i.phoneNumber).includes(e);if(console.log(n),n)alert("이미 회원가입 된 번호입니다. 로그인 페이지로 이동합니다! 😃"),window.location.href="/src/pages/login/";else{B();const i=JSON.stringify(e);localStorage.setItem("phoneNumber",i),console.log("저장 완료");const d=o(".signUp-input-after"),g=localStorage.getItem("phoneNumber");d.textContent=JSON.parse(g)}}s.addEventListener("click",x);const $=o(".signUp-input-verifyNumber");function M(e){const t=e.target.value;console.log(t),m===t?(console.log("성공!"),c(a,"bg-gray-500"),k(a,"bg-tertiary")):(console.log("실패!"),c(a,"bg-tertiary"),u(a,"bg-gray-500"))}$.addEventListener("input",M);async function F(){const e=Array.from(a.classList).includes("bg-tertiary"),t=await f.collection("users").getFullList();if(e){const r=Math.floor(Math.random()*1e3)+1e3,n=JSON.parse(localStorage.getItem("phoneNumber")),i={username:`${r}`,phoneNumber:`${n}`,password:`${n}`,passwordConfirm:`${n}`};await f.collection("users").create(i);let d={isAuth:!0},g=t.find(V=>V.phoneNumber===v.value);y("userId",g.id),y("auth",d),alert("로그인 성공!"),window.location.href="/src/pages/story/"}else alert("인증번호가 잘못되었습니다.")}a.addEventListener("click",F);const l=o(".signUp-button-Reverify"),J=I(".timer-button");let b=null,p=!1;function O(){const e=o(".target__time"),t=60;p?(clearInterval(b),e.textContent="",h(t,e),B()):h(t,e)}function h(e,t){let r,n;b=setInterval(function(){r=parseInt(e/60,10),n=parseInt(e%60,10),r=r<10?"0"+r:r,n=n<10?"0"+n:n,t.textContent=`${r} : ${n}`,--e<0&&(clearInterval(b),u(l,"bg-gray-500"),u(l,"text-background"),alert("시간초과! 인증번호를 다시 받아주세요 ⏳"),p=!1)},1e3),p=!0}J.forEach(e=>{e.addEventListener("click",O)});function R(){Array.from(l.classList).includes("bg-gray-500")&&Array.from(l.classList).includes("text-background")&&alert(m)}l.addEventListener("click",R);
