import"./tailwind-75xaDfuL.js";import{r as i,a as o}from"./css-LUmow4Y_.js";import{g as a,a as s}from"./delay-g6vF19wW.js";import{g as n}from"./storage-eNv634Ip.js";import{a as p,r as u}from"./rendering-oARfkKZz.js";import{p as c}from"./pocketbase-UOLpUAtS.js";import"./getPbImageURL-99Z79ldm.js";const g=a(".profileCard-button-close"),v=a(".profileCard-button-edit"),r=a(".profileCard-button-submit"),m=a(".profileCard-button-details"),C=a(".profileCard-button-editClose"),h=a("#avatar");function y(){history.back()}g.addEventListener("click",y);const b=await c.collection("users").getFullList(),E=await n("userId");let l=b.find(t=>t.id===E);async function L(){const t=await n("genderPrivacy"),e=await n("agePrivacy");t==="true"&&(a(".profile-gender-privacy").textContent="비공개"),e==="true"&&(a(".profile-age-privacy").textContent="비공개")}async function k(){await u(".rendering-box",l),L()}k();p(".rendering-photo",l);function w(){Array.from(s(".profile-textPrivacy")).forEach(e=>{let f=`${e.textContent.slice(0,4)}***`;e.textContent=f})}w();function P(){o(".profileCard-area-info","hidden"),o(".profileCard-button-edit","hidden"),i(".profileCard-area-edit","hidden"),i(".profileCard-button-editClose","hidden")}v.addEventListener("click",P);C.addEventListener("click",()=>{i(".profileCard-area-info","hidden"),i(".profileCard-button-edit","hidden"),o(".profileCard-area-edit","hidden"),o(".profileCard-button-editClose","hidden")});const x=Array.from(s(".radio-gender"));function D(){return x.find(e=>e.checked===!0).value}function I(){if(this.files&&this.files[0]){let t=new FileReader;t.onload=function(e){a(".profile-preview").src=e.target.result},t.readAsDataURL(this.files[0])}}h.addEventListener("change",I);const d=Array.from(s("form input"));function N(){let t=0;d.forEach(e=>{e.value&&t++}),t>=d.length-1?(r.classList.add("profileDetails-buttonAgree-valid"),r.classList.remove("bg-gray-100")):(r.classList.remove("profileDetails-buttonAgree-valid"),r.classList.add("bg-gray-100"))}d.forEach(t=>{t.addEventListener("change",N)});async function A(){const t=a("#avatar");try{const e=new FormData;t.value&&e.append("avatar",t.files[0]),e.append("username",a("#username").value),e.append("nickName",a("#nickName").value),e.append("gender",D()),e.append("age",a("#age").value),e.append("qualification",a("#qualification").value),await c.collection("users").update(l.id,e),alert("수정 완료"),location.href="/src/pages/profileDetails/"}catch{alert("정보를 올바르게 입력해주세요")}}r.addEventListener("click",A);m.addEventListener("click",()=>{location.href="/src/pages/profileDetails/"});
